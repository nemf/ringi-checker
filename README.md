# 📋 稟議書チェッカー

AI を活用した稟議書の品質チェック・改善提案システム

## 🎯 主な機能

### 📄 入力方法
- **PDFアップロード**: PDFファイルから自動テキスト抽出（PyPDF2 + pdfplumber）
- **テキスト直接入力**: 稟議書内容の直接入力
- **サンプル稟議書**: ワンクリックでサンプルデータ読み込み

### 🤖 AI分析
- **詳細チェック**: 5つのカテゴリで総合的な品質評価
- **5段階評価**: 各カテゴリを⭐マークで視覚的に評価
- **100点満点**: 総合スコアによる客観的評価
- **承認判定**: ○（承認可）/△（条件付き承認）/×（承認不可）

### 💡 改善提案
- **該当部分抜粋**: 問題箇所を具体的に指摘
- **評価根拠**: なぜその評価になったかの詳細説明
- **推奨修正案**: 実行可能な具体的改善提案
- **修正サンプル**: 重要部分の修正例を提示

### ⚙️ カスタマイズ機能
- **チェック項目編集**: 組織に応じたカスタマイズ
- **カテゴリ追加/削除**: 業界特化の評価項目設定
- **設定保存/読み込み**: カスタム設定のファイル管理
- **デフォルト復元**: 元の設定に簡単復元

## 🤖 対応AIモデル

| モデル | 特徴 | 用途 | トークン数 |
|--------|------|------|------------|
| **Claude 3.5 Sonnet** 🧠 | 最高性能 | 詳細な分析に最適 | 8,000 |
| **Nova Pro** 🚀 | Amazon最高性能 | 総合的な分析 | 5,000 |
| **Claude 3 Haiku** ⚡ | 高速処理 | 基本的な確認 | 4,000 |

## 📊 デフォルトチェック項目

### 1. 基本情報（20点）
- 件名が明確で具体的か
- 申請者・部署が明記されているか
- 申請日が記載されているか
- 承認者が適切に設定されているか

### 2. 内容・目的（25点）
- 申請の目的が明確に記載されているか
- 背景・理由が十分に説明されているか
- 期待される効果・メリットが記載されているか
- リスクや課題が検討されているか

### 3. 予算・コスト（20点）
- 予算額が明確に記載されているか
- 費用の内訳が詳細に記載されているか
- 予算根拠が合理的か
- ROI（投資対効果）が検討されているか

### 4. スケジュール（15点）
- 実施スケジュールが明確か
- 各フェーズの期限が設定されているか
- リソース配分が適切か
- 遅延リスクが考慮されているか

### 5. 文書品質（20点）
- 誤字脱字がないか
- 文章が分かりやすいか
- 論理的な構成になっているか
- 必要な添付資料があるか

## 🚀 ローカル環境での起動

### 前提条件
- Python 3.11以上
- AWS CLI設定済み（Amazon Bedrock アクセス用）

### セットアップ

```bash
# リポジトリをクローン
git clone https://github.com/nemf/ringi-checker.git
cd ringi-checker

# 仮想環境を作成・有効化
python -m venv claude_env
source claude_env/bin/activate  # Linux/Mac
# または
claude_env\Scripts\activate     # Windows

# 依存関係をインストール
pip install -r requirements.txt

# アプリケーションを起動
streamlit run ringi_checker.py
```

### AWS設定

Amazon Bedrock を使用するため、以下の設定が必要です：

```bash
# AWS認証情報を設定
aws configure

# 必要な権限
# - bedrock:InvokeModel
# - bedrock:ListFoundationModels
```

## 📝 使用方法

### 基本的な使い方

1. **入力方法選択**
   - 📄 PDFアップロード：稟議書PDFをドラッグ&ドロップ
   - ✏️ テキスト入力：稟議書内容を直接入力

2. **設定調整**（サイドバー）
   - 🤖 AIモデル選択：用途に応じてモデルを選択
   - 📋 チェック項目編集：必要に応じてカスタマイズ

3. **分析実行**
   - 🔍 「稟議書を詳細チェック」ボタンをクリック

4. **結果確認**
   - 📊 総合評価・最終判定を確認
   - 📈 カテゴリ別5段階評価を確認
   - 💡 改善提案を確認
   - 📥 結果をダウンロード

### チェック項目のカスタマイズ

1. **編集モード有効化**
   - サイドバーで「✏️ チェック項目を編集」をチェック

2. **項目編集**
   - 既存項目の修正
   - 新規項目の追加
   - 不要項目の削除

3. **カテゴリ管理**
   - 新しいカテゴリ追加
   - カテゴリ名変更
   - カテゴリ削除

4. **設定管理**
   - 💾 設定を保存：カスタム設定をファイルに保存
   - 📂 設定を読み込み：保存した設定を読み込み
   - 🔄 デフォルトに戻す：元の設定に復元

## 📊 出力結果の見方

### 総合評価・最終判定
- **評価点数**: 100点満点での総合スコア
- **承認可否**: ○（承認可）/△（条件付き承認）/×（承認不可）
- **判定理由**: 承認可否の具体的根拠
- **総合コメント**: 全体的な評価と印象

### カテゴリ別評価
- **5段階評価**: ⭐⭐⭐⭐⭐ (X/5) 形式
- **評価コメント**: 各カテゴリの簡潔な評価

### 詳細分析
- **該当部分抜粋**: 稟議書から関連部分を引用
- **評価根拠**: 評価の詳細な理由
- **推奨修正案**: 具体的な改善提案

### 改善支援
- **重要な指摘事項**: 承認に影響する重要な問題点
- **修正版サンプル**: 重要部分の修正例

## 🛠️ 技術スタック

- **Frontend**: Streamlit 1.37.1
- **Backend**: Python 3.11+
- **AI**: Amazon Bedrock (Claude & Nova)
- **PDF処理**: PyPDF2 3.0.1, pdfplumber 0.11.4
- **AWS SDK**: boto3 1.34.144

## 📁 ファイル構成

```
ringi-checker/
├── ringi_checker.py          # メインアプリケーション
├── requirements.txt          # Python依存関係
├── run_ringi_checker.sh     # 起動スクリプト
├── README.md                # このファイル
└── custom_check_items.json  # カスタム設定（自動生成）
```

## 🔒 セキュリティ

- AWS認証情報は環境変数またはAWS CLIで管理
- 稟議書データはセッション終了時に自動削除
- AIモデルへの送信データは暗号化通信

## 📄 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 🤝 貢献

バグ報告や機能要望は GitHub Issues でお知らせください。
